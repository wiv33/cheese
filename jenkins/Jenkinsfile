import java.text.SimpleDateFormat

node {

	parameters {
		string(name: 'BRANCH', defaultValue: 'develop', description: '')
	}

	stage('Src Checkout') {
		git branch: '${BRANCH}',
			credentialsId: 'xyz-github-access-token',
			url: 'https://github.com/wiv33/cheese.git'
	}

  	stage('Build') {
  		sh './gradlew bootJar'
  	}

  	stage('Docker build') {
	  	image = docker.build('psawesome/xyz-cheese-web:${BUILD_NUMBER}')
  	}

  	stage('Docker push') {
		docker.withRegistry('https://registry.hub.docker.com', dockerHubCred){
                        appImage.push("${env.BUILD_NUMBER}")
                        appImage.push("latest")
                    }
  	}
}